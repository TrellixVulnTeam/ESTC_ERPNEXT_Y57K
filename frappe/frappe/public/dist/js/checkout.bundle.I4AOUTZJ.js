(()=>{frappe.provide("frappe.checkout");frappe.require("https://checkout.razorpay.com/v1/checkout.js").then(()=>{frappe.checkout.razorpay=class{constructor(r){Object.assign(this,r)}init(){frappe.run_serially([()=>this.get_key(),()=>this.make_order(),()=>this.prepare_options(),()=>this.setup_handler(),()=>this.show()])}show(){this.razorpay=new Razorpay(this.options),this.razorpay.once("ready",r=>{this.on_open&&this.on_open(r)}),this.razorpay.open()}get_key(){return new Promise(r=>{frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.get_api_key").then(e=>{this.key=e.message,r(!0)})})}make_order(){return new Promise(r=>{frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.get_order",{doctype:this.doctype,docname:this.docname}).then(e=>{this.order=e.message,r(!0)})})}order_success(r){frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.order_payment_success",{integration_request:this.order.integration_request,params:{razorpay_payment_id:r.razorpay_payment_id,razorpay_order_id:r.razorpay_order_id,razorpay_signature:r.razorpay_signature}})}order_fail(r){frappe.call("frappe.integrations.doctype.razorpay_settings.razorpay_settings.order_payment_failure",{integration_request:this.order.integration_request,params:r})}prepare_options(){this.options={key:this.key,amount:this.order.amount_due,currency:this.order.currency,name:this.name,description:this.description,image:this.image,order_id:this.order.id,prefill:this.prefill,theme:this.theme,modal:this.modal}}setup_handler(){this.options.handler=r=>{r.error?(this.order_fail(r),this.on_fail&&this.on_fail(r)):r.razorpay_payment_id&&(this.order_success(r),this.on_success&&this.on_success(r))}}}});})();
//# sourceMappingURL=checkout.bundle.I4AOUTZJ.js.map
